name: Deploy on Heroku

# Controls when the workflow will run
on:
  # Triggers the workflow on push or pull request events but only for the main branch
  push:
    branches: [main]
  pull_request:
    branches: [main]

jobs:
  HerokuDeploy:
    runs-on: ubuntu-latest
steps:
  - name: Checkout
    uses: actions/checkout@v2
  - name: Build, Push and Deploy to Heroku #set the whatever name you want to this step
    id: heroku
    uses: snithyanantham/docker-compose-multiple-apps-heroku-deploy@v1.0 # use the latest version of the action
    with:
      email: ${{ secrets.HEROKU_EMAIL }} # your heroku email
      api_key: ${{ secrets.HEROKU_API_KEY }} # your  heroku api key
      docker_compose_file: "../../docker-compose.yml" # set the path to the folder where the docker-compose file is located
      heroku_apps: '[{"imagename":"node:16.15","appname":"anime-me-api","apptype":"web"},{"imagename":"postgres:14.1-alpine","appname":"anime-me-api","apptype":"web"}]' # List of Docker Image name, Heroku app and Heroku app type
